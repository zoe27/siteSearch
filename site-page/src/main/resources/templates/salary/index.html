<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8"/>
        <title>招聘网职位列表</title>
        <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport"/>
        <meta content="yes" name="apple-mobile-web-app-capable"/>
        <meta content="black" name="apple-mobile-web-app-status-bar-style"/>
        <meta content="telephone=no" name="format-detection"/>
        <link th:href="@{/salary/css/dropload.css}" type="text/css" rel="stylesheet" />
        <link th:href="@{/salary/css/style.css}" rel="stylesheet" type="text/css"/>

        <script th:src="@{/js/jquery-3.3.1.min.js}" type="text/javascript"></script>

        
    </head>
    <body>

        <section class="aui-flexView">
            <header class="aui-navBar aui-navBar-fixed">
                <div class="aui-center aui-center-clear">
                   <div class="aui-job-search">
                       <div class="aui-job-search-box">
                           <i class="icon icon-search"></i>
                           <input type="text" placeholder="搜索职位/公司"/>
                       </div>
                   </div>
                </div>

                <a href="javascript:;" class="aui-navBar-item">
                    <div class="aui-icon-s"><i class="icon icon-sys"></i></div>
                    <div>扫一扫</div>
                </a>
            </header>

            <section class="aui-scrollView">
                <div class="divHeight"></div>
<!--                <div class="aui-job-list" id="aui-job-list">-->
<!--                    <a href="javascript:;" class="aui-flex">-->
<!--                        <div class="aui-flex-box">-->
<!--                            <h2>web前端高级工程师开发</h2>-->
<!--                            <p>北京 5-10年 本科</p>-->
<!--                            <span>-->
<!--                                <em>周末双休</em>-->
<!--                                <em>五险一金</em>-->
<!--                                <em>年底双薪</em>-->
<!--                                <em>节日福利</em>-->
<!--                            </span>-->
<!--                            <p>北京AUI素材网网络科技有限公司</p>-->
<!--                        </div>-->
<!--                        <div class="aui-monthly">-->
<!--                            <h3>5万-7万月</h3>-->
<!--                            <p>10月25</p>-->
<!--                        </div>-->
<!--                    </a>-->
<!--                    <div class="test"></div>-->

<!--                </div>-->
            </section>


            <div class="aui-job-list">
                <a href="javascript:;" class="aui-flex">
                    <div class="aui-flex-box">
                        <h2>web前端高级工程师开发</h2>
                        <p>北京 5-10年 本科</p>
                        <span>
                                <em>周末双休</em>
                                <em>五险一金</em>
                                <em>年底双薪</em>
                                <em>节日福利</em>
                            </span>
                        <p>北京AUI素材网网络科技有限公司</p>
                    </div>
                    <div class="aui-monthly">
                        <h3>5万-7万月</h3>
                        <p>10月25</p>
                    </div>
                </a>
                <div class="test"></div>
            </div>

            <footer class="aui-footer">
                <a href="javascript:;" class="aui-tabBar-item aui-tabBar-item-active">
                    <span class="aui-tabBar-item-icon">
                        <i class="icon icon-home"></i>
                    </span>
                    <span class="aui-tabBar-item-text">职位</span>
                </a>
                <a href="javascript:;" class="aui-tabBar-item ">
                    <span class="aui-tabBar-item-icon">
                        <i class="icon icon-loan"></i>
                    </span>
                    <span class="aui-tabBar-item-text">消息</span>
                </a>
                <a href="javascript:;" class="aui-tabBar-item ">
                    <span class="aui-tabBar-item-icon">
                        <i class="icon icon-find"></i>
                    </span>
                    <span class="aui-tabBar-item-text">职场</span>
                </a>
                <a href="javascript:;" class="aui-tabBar-item ">
                    <span class="aui-tabBar-item-icon">
                        <i class="icon icon-car"></i>
                    </span>
                    <span class="aui-tabBar-item-text">简历</span>
                </a>
                <a href="javascript:;" class="aui-tabBar-item ">
                    <span class="aui-tabBar-item-icon">
                        <i class="icon icon-me"></i>
                    </span>
                    <span class="aui-tabBar-item-text">我的</span>
                </a>
            </footer>
        </section>

    </body>

<script th:src="@{/salary/js/dropload.js}" type="text/javascript"></script>
<script th:src="@{/salary/js/salary.js}" type="text/javascript"></script>

<script>
    $(function(){
        var counter = 0;
        // 每页展示4个
        var num = 10;
        var pageStart = 0,pageEnd = 0;

        // dropload
        var dropload = $('.aui-job-list').dropload({
            scrollArea : window,

            loadDownFn : function(me){
                console.log('/getSalary?begin='+pageStart+'&amp;limit='+num)
                $.ajax({
                    type: 'GET',
                    url: '/getSalary?begin='+pageStart+'&amp;limit='+num,
                    dataType: 'json',
                    success: function(data){
                        var result = setData(data.t);
                        //counter++;
                        //pageEnd = num * counter;
                        //pageStart = pageEnd - num;
                        pageStart++;

                        /*<![CDATA[*/if (data.t.length < num){
                            // 锁定
                            me.lock();
                            // 无数据
                            me.noData();
                        }
                        /*]]>*/
                        
                        // 为了测试，延迟1秒加载
                        setTimeout(function(){
                            $('.test').append(result);
                            // 每次数据加载完，必须重置
                            me.resetload();
                        },1000);
                    },
                    error: function(xhr, type){
                        // 即使加载出错，也得重置
                        me.resetload();
                    }
                });
            },
            threshold : 50
        });
    });
</script>
</html>
